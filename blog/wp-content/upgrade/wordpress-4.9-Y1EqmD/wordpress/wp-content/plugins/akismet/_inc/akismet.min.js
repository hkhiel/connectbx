jQuery(function(t){function e(a,o){var n=t(".checkforspam"),i=Math.round(c/n.data("pending-comment-count")*1e3)/10;t(".checkforspam-progress").text(n.data("progress-label-format").replace("%1$s",i)),t.post(ajaxurl,{action:"akismet_recheck_queue",offset:a,limit:o},function(t){c+=t.counts.processed,m+=t.counts.spam,t.counts.processed<o?window.location.href=n.data("success-url").replace("__recheck_count__",c).replace("__spam_count__",m):e(a+o-t.counts.spam,o)})}function a(){t("#the-comment-list").find('tr.comment, tr[id ^= "comment-"]').find('.column-author a[href^="http"]:first').each(function(){if(!(t(this).parent().find(".akismet_remove_url").length>0)){var e=t(this).attr("href"),a=document.location.href.split("/"),o=a[0]+"//"+a[2]+"/";if(0!=e.indexOf(o)){var n=t(this).parents("tr:first").attr("id").split("-");t(this).attr("id","author_comment_url_"+n[1]).after(t('<a href="#" class="akismet_remove_url">x</a>').attr("commentid",n[1]).attr("title",WPAkismet.strings["Remove this URL"]))}}})}function o(t,e){var a="//s0.wordpress.com/mshots/v1/"+encodeURIComponent(t)+"?w=900";return e&&(a+="&r="+encodeURIComponent(e)),a}var n=null,i=null,s=null,r='a[id^="author_comment_url"], tr.pingback td.column-author a:first-of-type, td.comment p a';t(".akismet-status").each(function(){var e=t(this).attr("commentid");t(this).prependTo("#comment-"+e+" .column-comment")}),t(".akismet-user-comment-count").each(function(){var e=t(this).attr("commentid");t(this).insertAfter("#comment-"+e+" .author strong:first").show()}),a(),t("#the-comment-list").on("click",".akismet_remove_url",function(){var e=t(this).attr("commentid"),a={action:"comment_author_deurl",_wpnonce:WPAkismet.comment_author_url_nonce,id:e};return t.ajax({url:ajaxurl,type:"POST",data:a,beforeSend:function(){t("a[commentid='"+e+"']").hide(),t("#author_comment_url_"+e).html(t("<span/>").text(WPAkismet.strings["Removing..."]))},success:function(a){a&&t("#author_comment_url_"+e).attr("cid",e).addClass("akismet_undo_link_removal").html(t("<span/>").text(WPAkismet.strings["URL removed"])).append(" ").append(t("<span/>").text(WPAkismet.strings["(undo)"]).addClass("akismet-span-link"))}}),!1}).on("click",".akismet_undo_link_removal",function(){var e=t(this).attr("cid"),a=t(this).attr("href"),o={action:"comment_author_reurl",_wpnonce:WPAkismet.comment_author_url_nonce,id:e,url:a};return t.ajax({url:ajaxurl,type:"POST",data:o,beforeSend:function(){t("#author_comment_url_"+e).html(t("<span/>").text(WPAkismet.strings["Re-adding..."]))},success:function(o){o&&(t("a[commentid='"+e+"']").show(),t("#author_comment_url_"+e).removeClass("akismet_undo_link_removal").text(a.replace(/^http:\/\/(www\.)?/gi,"")))}}),!1}),t("#the-comment-list").on("mouseover",r,function(){if(clearTimeout(n),t(".akismet-mshot").length>0){if(t(".akismet-mshot:first").data("link")==this)return;t(".akismet-mshot").remove()}clearTimeout(i),clearTimeout(s);var e=t(this).attr("href"),a=t('<div class="akismet-mshot mshot-container"><div class="mshot-arrow"></div><img src="'+o(e)+'" width="450" height="338" class="mshot-image" /></div>');a.data("link",this);var r=t(this).offset();a.offset({left:Math.min(t(window).width()-475,r.left+t(this).width()+10),top:r.top+t(this).height()/2-101}),i=setTimeout(function(){a.find(".mshot-image").attr("src",o(e,2))},6e3),s=setTimeout(function(){a.find(".mshot-image").attr("src",o(e,3))},12e3),t("body").append(a)}).on("mouseout",'a[id^="author_comment_url"], tr.pingback td.column-author a:first-of-type, td.comment p a',function(){n=setTimeout(function(){clearTimeout(i),clearTimeout(s),t(".akismet-mshot").remove()},200)}).on("mouseover","tr",function(){t(this).find(r).each(function(){t(this).data("akismet-mshot-preloaded")||(!function(t){(new Image).src=o(t)}(t(this).attr("href")),t(this).data("akismet-mshot-preloaded",!0))})}),t(".checkforspam:not(.button-disabled)").click(function(a){a.preventDefault(),t(".checkforspam:not(.button-disabled)").addClass("button-disabled"),t(".checkforspam-spinner").addClass("spinner").addClass("is-active"),t(".checkforspam .akismet-label").text(t(".checkforspam").data("active-label")),e(0,100)});var m=0,c=0;if("start_recheck"in WPAkismet&&WPAkismet.start_recheck&&t(".checkforspam").click(),"undefined"!=typeof MutationObserver){var u=document.getElementById("the-comment-list");if(u){new MutationObserver(function(t){for(var e=0,o=t.length;e<o;e++)if(t[e].addedNodes.length>0){a();break}}).observe(u,{attributes:!0,childList:!0,characterData:!0})}}});